import{d as C,r as u,u as T,l as D,b as f,f as e,c as s,w as n,p as E,h as M,z as A,o as h,_ as Q}from"./index-DO-l4tIR.js";import{C as R,B as S}from"./index-CzWMtT1i.js";import"./index-C8IO6k9C.js";import{F as G}from"./index-BQ62ZMvP.js";import{_ as I,F as O}from"./logo2-DEWW0zZM.js";import{s as H}from"./request-vocc818-.js";import{a as v}from"./function-call-CaVRAmu7.js";import"./use-route-lDfftLAJ.js";import"./index-C0LVEZzw.js";import"./index-BZ0O1QaC.js";import"./index-T6Dye2l5.js";import"./constant-CRwwH2e9.js";import"./use-id-DRzkz_RB.js";import"./use-expose-buKm2G0G.js";import"./use-touch-Uh-j500R.js";import"./on-popup-reopen-D5u2-ffw.js";import"./interceptor-CeEcvsXT.js";const L={class:"login"},U={class:"login-container"},V={style:{display:"flex","justify-content":"space-between"}},X={style:{margin:"3.7vw 0"}},z=C({__name:"LoginTG",setup(F){const p=u(""),r=u(""),d=T(),c=E(),w=u("");function _(t){t=t.replace(/-/g,"+").replace(/_/g,"/");const o=t.length%4;o&&(t+="=".repeat(4-o));const a=Uint8Array.from(atob(t),l=>l.charCodeAt(0));return new TextDecoder().decode(a)}const g=(t,o)=>{H.post(o,t).then(a=>{if(a.data.access_token){const l=d.query.redirect,i=Array.isArray(l)?l[0]:l||"/";c.replace(i),localStorage.setItem("Authorization",a.data.token_type+" "+a.data.access_token),localStorage.setItem("refresh_token",a.data.refresh_token)}else v("登录失败")}).catch(a=>{console.error("toLogin error: ",a)})},b=()=>{if(r.value.length<6||r.value.length>20){v("密码长度必须在 6-20 位");return}const t={email:p.value,password:r.value};g(t,"/api/auth/email-login")},k=()=>{if(window.Telegram&&window.Telegram.WebApp&&window.Telegram.WebApp.initData)console.log("Telegram WebApp 登录"),w.value=window.Telegram.WebApp.initData||"",g({initData:w.value},"/api/auth/telegram/webapp-login");else{console.log("Telegram Bot 登录");const t=location.origin,o="8303051100";window.location.href=`https://oauth.telegram.org/auth?bot_id=${o}&origin=${t}/login`}};if(d.hash.includes("tgAuthResult")){const t=d.hash.replace("#tgAuthResult=",""),o=JSON.parse(_(t));g(o,"/api/auth/telegram/bot-login")}const y=()=>{window.history.state?.back?c.back():c.push("/")};return D(()=>{window.Telegram&&window.Telegram.WebApp&&!localStorage.getItem("Authorization")&&console.log(window.Telegram.WebApp)}),(t,o)=>{const a=G,l=R,i=M("router-link"),B=S,x=O;return h(),f("div",L,[e("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAAAXNSR0IArs4c6QAAAXNJREFUaEPt2TtKBEEYReFzMZMBd+ASXIGBmhgaGbkDlyGGJgYuQBAjAzP3YOoCRMHcRMTEkoYOOpgHXfU/ZrArmWD6cb6qoXqgxYYPbXg/EyB7BacV+LcrUEqZAXfAEXAl6aJmMlJ+Qn38E7DfR/8CM0nfYxHhgDnxXfOLpL2x8d3xoYAF8a/AoaS3tQZ4xIetgFd8CMAz3h3gHe8KiIh3AyyJP5D0XrPbLDrHfBuNjDdfgeh4U0BGvBkgK94EkBnfDMiObwKsQ3wr4BE4GezP3b9K831+1TOj+jlQSvkCtgc3OJX0sOqG1t+3AG6A80HQJ3As6dk6ctn1WgBbwC1wlomoBnTRpZR0RBNgHRDNgGyECSATYQbIQpgCMhDmgGiECyAS4QaIQrgCIhDuAG9ECMATEQbwQoQCliA+gF1J3YuOUSMcsADxA+xI6j5HjRTAAHHZvyO7lnQ/qrw/OA1QEzvvnAlgNZO115lWoHbmrM77A89a2jFh78iUAAAAAElFTkSuQmCC",alt:"返回",class:"left-arrow",onClick:y}),e("div",U,[o[9]||(o[9]=e("div",{class:"logo-section"},[e("img",{src:I,alt:"Logo",class:"logo"})],-1)),s(x,{onSubmit:b},{default:n(()=>[s(l,{inset:"",class:"form-group"},{default:n(()=>[s(a,{modelValue:p.value,"onUpdate:modelValue":o[0]||(o[0]=m=>p.value=m),type:"email",placeholder:"请输入邮箱","label-width":"5vw",class:"input-field"},{label:n(()=>o[2]||(o[2]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"5vw",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[e("path",{d:"M12 12c2.21 0 4-1.79 4-4S14.21 4 12 4 8 5.79 8 8s1.79 4 4 4z"}),e("path",{d:"M12 14c-4 0-8 2-8 6v2h16v-2c0-4-4-6-8-6z"})],-1)])),_:1},8,["modelValue"])]),_:1}),s(l,{inset:"",class:"form-group"},{default:n(()=>[s(a,{modelValue:r.value,"onUpdate:modelValue":o[1]||(o[1]=m=>r.value=m),type:"password",placeholder:"请输入密码","show-message":!1,class:"input-field","label-width":"5vw"},{label:n(()=>o[3]||(o[3]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"5vw",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[e("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),e("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})],-1)])),_:1},8,["modelValue"])]),_:1}),e("div",V,[s(i,{to:{name:"register"},class:"link"},{default:n(()=>o[4]||(o[4]=[A("立即注册")])),_:1,__:[4]}),s(i,{to:"",class:"link"},{default:n(()=>o[5]||(o[5]=[A("忘记密码")])),_:1,__:[5]})]),e("div",X,[s(B,{block:"",type:"primary","native-type":"submit",style:{height:"11vw"}},{default:n(()=>o[6]||(o[6]=[A(" 登录 ")])),_:1,__:[6]})]),o[8]||(o[8]=e("div",{class:"divider"},"快速登录",-1)),(h(),f("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 80 80",class:"tg-icon",onClick:k},o[7]||(o[7]=[e("g",{"clip-path":"url(#i389236776__a)"},[e("ellipse",{cx:"39.5",cy:"39.5",fill:"#fff",rx:"31.5",ry:"30.5"}),e("path",{fill:"#1296DB",d:"m53.08 58.349 6.563-30.938c.58-2.722-.983-3.794-2.769-3.125L18.303 39.15c-2.635 1.026-2.589 2.5-.446 3.169l9.866 3.08 22.903-14.42c1.071-.714 2.054-.311 1.251.403l-18.526 16.74-.714 10.18c1.026 0 1.474-.446 2.009-.983l4.82-4.643 10 7.366c1.831 1.026 3.126.491 3.617-1.697l-.003.003ZM80 40c0 22.097-17.903 40-40 40S0 62.097 0 40 17.903 0 40 0s40 17.903 40 40Z"})],-1),e("defs",null,[e("clipPath",{id:"i389236776__a"},[e("path",{fill:"#fff",d:"M0 0h80v80H0z"})])],-1)])))]),_:1,__:[8]})])])}}}),ro=Q(z,[["__scopeId","data-v-a5f592f3"]]);export{ro as default};
