import{d as q,r as l,a as F,u as M,k as Y,b as p,f as s,t as B,c as g,w as r,p as I,F as b,e as w,i as x,x as L,o as n,_ as S}from"./index-CE-iaIph.js";import{P as V}from"./index-C8kCWPbc.js";import{L as j}from"./index-BqzntutB.js";import{R as J,a as P,C as z}from"./CoverComp-26MKZKq9.js";import{T as Z,a as K}from"./index-NQrTex6L.js";import{s as E}from"./request-BzuFj0hJ.js";import"./index-CECtwLFq.js";import"./use-id-CKdZKr93.js";import"./use-route-Ch0WDgF2.js";const W={class:"channel_navigation flex h_100_vh flex_direction-column"},$={class:"nav-bar relative van-hairline--bottom"},ee={class:"center flex_auto"},ae={class:"flex_auto page_content relative"},te={class:"load-box"},se={class:"scroll-box"},oe={class:"overflow-hidden"},le={class:"load-box bottom_load_box"},ne=q({__name:"FilterView",setup(ie){const C=l(1),_=l(!1),f=I(),c=M(),o=F({get:()=>({channeid:c.query.channeid,ids:c.query.ids,page:c.query.page?Number(c.query.page):C.value,size:20}),set:e=>{e.page!==void 0&&(C.value=e.page)}}),A=l([]),u=l(!1),d=l(!1),h=l(),i=l([]),y=l({list:[]}),m=async()=>{u.value=!0;try{const e=await E.get("/api/list/getfiltersdata",{params:o.value}),a=e.data.data?.list?.length??0;d.value=a===0||a<o.value.size,i.value.push(...e.data.data?.list??[])}catch(e){console.error("失败：",e),_.value=!0,o.value.page--}u.value=!1},R=async()=>{d.value=!1,o.value.page=1,i.value=[],await m(),h.value=!1},Q=async()=>{d.value=!1,o.value.page=1,o.value.ids=A.value.map((e,a)=>y.value.list[a]?.list[e]?.index??0).join(","),f.replace({query:{...c.query,ids:o.value.ids}}),i.value=[],await m()},D=async()=>{o.value.page++,await m(),u.value=!1};Y(async()=>{if(!f.options.history.state.forward||!i.value.length){d.value=!1,A.value=o.value.ids.split(",").map(e=>Number(e)),o.value.page=1,i.value=[],await m();try{const e=await E.get("/api/list/getfilterstags");y.value=e.data.data}catch(e){console.error("失败：",e)}}});const N=()=>{window.history.state?.back?f.back():f.push("/")};return(e,a)=>{const O=K,U=Z,G=z,H=J,T=j,X=V;return n(),p("div",W,[s("div",$,[s("div",{class:"left",onClick:N},a[3]||(a[3]=[s("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAAAXNSR0IArs4c6QAAAXNJREFUaEPt2TtKBEEYReFzMZMBd+ASXIGBmhgaGbkDlyGGJgYuQBAjAzP3YOoCRMHcRMTEkoYOOpgHXfU/ZrArmWD6cb6qoXqgxYYPbXg/EyB7BacV+LcrUEqZAXfAEXAl6aJmMlJ+Qn38E7DfR/8CM0nfYxHhgDnxXfOLpL2x8d3xoYAF8a/AoaS3tQZ4xIetgFd8CMAz3h3gHe8KiIh3AyyJP5D0XrPbLDrHfBuNjDdfgeh4U0BGvBkgK94EkBnfDMiObwKsQ3wr4BE4GezP3b9K831+1TOj+jlQSvkCtgc3OJX0sOqG1t+3AG6A80HQJ3As6dk6ctn1WgBbwC1wlomoBnTRpZR0RBNgHRDNgGyECSATYQbIQpgCMhDmgGiECyAS4QaIQrgCIhDuAG9ECMATEQbwQoQCliA+gF1J3YuOUSMcsADxA+xI6j5HjRTAAHHZvyO7lnQ/qrw/OA1QEzvvnAlgNZO115lWoHbmrM77A89a2jFh78iUAAAAAElFTkSuQmCC",alt:"",class:"left-arrow"},null,-1)])),s("div",ee,B(i.value?.[0]?.type),1),a[4]||(a[4]=s("div",{class:"right"},null,-1))]),s("div",ae,[s("div",te,[s("div",se,[g(X,{modelValue:h.value,"onUpdate:modelValue":a[2]||(a[2]=t=>h.value=t),onRefresh:R,"success-text":"刷新成功"},{default:r(()=>[s("div",oe,[(n(!0),p(b,null,w(y.value.list,(t,k)=>(n(),p("div",{class:"tabs",key:t.name},[g(U,{active:A.value[k],"onUpdate:active":v=>A.value[k]=v,onChange:Q,role:""},{default:r(()=>[(n(!0),p(b,null,w(t.list,v=>(n(),x(O,{key:v.classifyId},{title:r(()=>[s("span",null,B(v.classifyName=="全部"?"最近上传":v.classifyName),1)]),_:2},1024))),128))]),_:2},1032,["active","onUpdate:active"])]))),128)),s("div",le,[g(T,{loading:u.value,"onUpdate:loading":a[0]||(a[0]=t=>u.value=t),"immediate-check":!1,finished:d.value,error:_.value,"onUpdate:error":a[1]||(a[1]=t=>_.value=t),"error-text":"请求失败，点击重新加载","finished-text":"没有更多了",onLoad:D,class:"list",role:""},{default:r(()=>[g(H,{gutter:"10"},{default:r(()=>[(n(!0),p(b,null,w(i.value,t=>(n(),x(G,{key:t.id,span:"8"},{default:r(()=>[t.shortId?(n(),x(P,{key:0,MvItem:t,islist:!1},null,8,["MvItem"])):L("",!0)]),_:2},1024))),128))]),_:1})]),_:1},8,["loading","finished","error"])])])]),_:1},8,["modelValue"])])])])])}}}),ge=S(ne,[["__scopeId","data-v-df9c4d0a"]]);export{ge as default};
