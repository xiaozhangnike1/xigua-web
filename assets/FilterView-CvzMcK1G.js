import{d as q,r as l,a as F,u as M,k as Y,b as p,f as s,t as B,c as g,w as r,p as I,F as b,e as w,i as x,x as L,o as i,_ as S}from"./index-Ha6_R1b4.js";import{P as V}from"./index-p8kqW8uK.js";import{L as j}from"./index-CBGIZuza.js";import{R as J,a as P,C as z}from"./CoverComp-1Dtja4MO.js";import{T as Z,a as K}from"./index-D5W-FGia.js";import{s as E}from"./request-CPoeBKFh.js";import"./index-vKgYhTR5.js";import"./use-touch-CdP2QCc-.js";import"./index-BRbdKhwT.js";import"./index-Cu6jeTUs.js";import"./use-id-BZXBEZ28.js";import"./use-route-Bi0Ce5lm.js";import"./interceptor-fgq4YbAq.js";const W={class:"channel_navigation flex h_100_vh flex_direction-column"},$={class:"nav-bar relative van-hairline--bottom"},ee={class:"center flex_auto"},ae={class:"flex_auto page_content relative"},te={class:"load-box"},se={class:"scroll-box"},oe={class:"overflow-hidden"},le={class:"load-box bottom_load_box"},ie=q({__name:"FilterView",setup(ne){const C=l(1),_=l(!1),f=I(),c=M(),o=F({get:()=>({channeid:c.query.channeid,ids:c.query.ids,page:c.query.page?Number(c.query.page):C.value,size:20}),set:e=>{e.page!==void 0&&(C.value=e.page)}}),m=l([]),u=l(!1),d=l(!1),h=l(),n=l([]),y=l({list:[]}),A=async()=>{u.value=!0;try{const e=await E.get("/api/list/getfiltersdata",{params:o.value}),a=e.data.data?.list?.length??0;d.value=a===0||a<o.value.size,n.value.push(...e.data.data?.list??[])}catch(e){console.error("失败：",e),_.value=!0,o.value.page--}u.value=!1},R=async()=>{d.value=!1,o.value.page=1,n.value=[],await A(),h.value=!1},Q=async()=>{d.value=!1,o.value.page=1,o.value.ids=m.value.map((e,a)=>y.value.list[a]?.list[e]?.index??0).join(","),f.replace({query:{...c.query,ids:o.value.ids}}),n.value=[],await A()},D=async()=>{o.value.page++,await A(),u.value=!1};Y(async()=>{if(!f.options.history.state.forward||!n.value.length){d.value=!1,m.value=o.value.ids.split(",").map(e=>Number(e)),o.value.page=1,n.value=[],await A();try{const e=await E.get("/api/list/getfilterstags");y.value=e.data.data}catch(e){console.error("失败：",e)}}});const N=()=>{window.history.state?.back?f.back():f.push("/")};return(e,a)=>{const O=K,U=Z,G=z,H=J,T=j,X=V;return i(),p("div",W,[s("div",$,[s("div",{class:"left",onClick:N},a[3]||(a[3]=[s("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAAAXNSR0IArs4c6QAAAXNJREFUaEPt2TtKBEEYReFzMZMBd+ASXIGBmhgaGbkDlyGGJgYuQBAjAzP3YOoCRMHcRMTEkoYOOpgHXfU/ZrArmWD6cb6qoXqgxYYPbXg/EyB7BacV+LcrUEqZAXfAEXAl6aJmMlJ+Qn38E7DfR/8CM0nfYxHhgDnxXfOLpL2x8d3xoYAF8a/AoaS3tQZ4xIetgFd8CMAz3h3gHe8KiIh3AyyJP5D0XrPbLDrHfBuNjDdfgeh4U0BGvBkgK94EkBnfDMiObwKsQ3wr4BE4GezP3b9K831+1TOj+jlQSvkCtgc3OJX0sOqG1t+3AG6A80HQJ3As6dk6ctn1WgBbwC1wlomoBnTRpZR0RBNgHRDNgGyECSATYQbIQpgCMhDmgGiECyAS4QaIQrgCIhDuAG9ECMATEQbwQoQCliA+gF1J3YuOUSMcsADxA+xI6j5HjRTAAHHZvyO7lnQ/qrw/OA1QEzvvnAlgNZO115lWoHbmrM77A89a2jFh78iUAAAAAElFTkSuQmCC",alt:"",class:"left-arrow"},null,-1)])),s("div",ee,B(n.value?.[0]?.type),1),a[4]||(a[4]=s("div",{class:"right"},null,-1))]),s("div",ae,[s("div",te,[s("div",se,[g(X,{modelValue:h.value,"onUpdate:modelValue":a[2]||(a[2]=t=>h.value=t),onRefresh:R,"success-text":"刷新成功"},{default:r(()=>[s("div",oe,[(i(!0),p(b,null,w(y.value.list,(t,k)=>(i(),p("div",{class:"tabs",key:t.name},[g(U,{active:m.value[k],"onUpdate:active":v=>m.value[k]=v,onChange:Q,role:""},{default:r(()=>[(i(!0),p(b,null,w(t.list,v=>(i(),x(O,{key:v.classifyId},{title:r(()=>[s("span",null,B(v.classifyName=="全部"?"最近上传":v.classifyName),1)]),_:2},1024))),128))]),_:2},1032,["active","onUpdate:active"])]))),128)),s("div",le,[g(T,{loading:u.value,"onUpdate:loading":a[0]||(a[0]=t=>u.value=t),"immediate-check":!1,finished:d.value,error:_.value,"onUpdate:error":a[1]||(a[1]=t=>_.value=t),"error-text":"请求失败，点击重新加载","finished-text":"没有更多了",onLoad:D,class:"list",role:""},{default:r(()=>[g(H,{gutter:"10"},{default:r(()=>[(i(!0),p(b,null,w(n.value,t=>(i(),x(G,{key:t.id,span:"8"},{default:r(()=>[t.shortId?(i(),x(P,{key:0,MvItem:t,islist:!1},null,8,["MvItem"])):L("",!0)]),_:2},1024))),128))]),_:1})]),_:1},8,["loading","finished","error"])])])]),_:1},8,["modelValue"])])])])])}}}),be=S(ie,[["__scopeId","data-v-df9c4d0a"]]);export{be as default};
