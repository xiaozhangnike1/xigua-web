import{t as H,d as J,n as T,o as Ke,f as Ue,p as Y,c as oe,h as re,e as $,g as Ge,j as L,w as ce,k as E,H as Ye,P as Ze,l as Je,i as we,s as Qe,q as Xe,r as pe,a as et,v as ve,x as tt,y as nt,m as ot,F as at,z as he,A as lt,C as it,D as st,E as rt,G as ct}from"./index-vKgYhTR5.js";import{C as ut,c as dt}from"./index-nYdqGnv8.js";import{u as ft}from"./use-id-BZXBEZ28.js";import{a as mt,u as ue}from"./use-touch-CdP2QCc-.js";import{I as Z}from"./index-Cu6jeTUs.js";import{E as xe,G as gt,H as N,r as M,d as ae,c,T as Oe,I as Pe,s as Te,v as Ee,m as D,a as _,l as de,k as vt,F as ht,n as G,J as Be,L as Le,z as yt,M as bt,N as Ct,g as kt}from"./index-Ha6_R1b4.js";import{u as ye}from"./index-1s1b2Sd8.js";import{c as It}from"./interceptor-fgq4YbAq.js";import{L as St}from"./index-BRbdKhwT.js";let wt=2e3;const xt=()=>++wt,Ot={show:Boolean,zIndex:T,overlay:H,duration:T,teleport:[String,Object],lockScroll:H,lazyRender:H,beforeClose:Function,overlayProps:Object,overlayStyle:Object,overlayClass:J,transitionAppear:Boolean,closeOnClickOverlay:H};let K=0;const be="van-overflow-hidden";function Pt(e,n){const o=mt(),s="01",a="10",r=u=>{o.move(u);const v=o.deltaY.value>0?a:s,y=Ue(u.target,e.value),{scrollHeight:O,offsetHeight:A,scrollTop:S}=y;let k="11";S===0?k=A>=O?"00":"01":S+A>=O&&(k="10"),k!=="11"&&o.isVertical()&&!(parseInt(k,2)&parseInt(v,2))&&Y(u,!0)},h=()=>{document.addEventListener("touchstart",o.start),document.addEventListener("touchmove",r,{passive:!1}),K||document.body.classList.add(be),K++},f=()=>{K&&(document.removeEventListener("touchstart",o.start),document.removeEventListener("touchmove",r),K--,K||document.body.classList.remove(be))},d=()=>n()&&h(),C=()=>n()&&f();Ke(d),xe(C),gt(C),N(n,u=>{u?h():f()})}function Ae(e){const n=M(!1);return N(e,o=>{o&&(n.value=o)},{immediate:!0}),o=>()=>n.value?o():null}const[Tt,Et]=oe("overlay"),Bt={show:Boolean,zIndex:T,duration:T,className:J,lockScroll:H,lazyRender:H,customStyle:Object,teleport:[String,Object]};var Lt=ae({name:Tt,inheritAttrs:!1,props:Bt,setup(e,{attrs:n,slots:o}){const s=M(),a=Ae(()=>e.show||!e.lazyRender),r=f=>{e.lockScroll&&Y(f,!0)},h=a(()=>{var f;const d=$(Ge(e.zIndex),e.customStyle);return L(e.duration)&&(d.animationDuration=`${e.duration}s`),Te(c("div",D({ref:s,style:d,class:[Et(),e.className]},n),[(f=o.default)==null?void 0:f.call(o)]),[[Ee,e.show]])});return re("touchmove",r,{target:s}),()=>{const f=c(Oe,{name:"van-fade",appear:!0},{default:h});return e.teleport?c(Pe,{to:e.teleport},{default:()=>[f]}):f}}});const At=ce(Lt),zt=$({},Ot,{round:Boolean,position:E("center"),closeIcon:E("cross"),closeable:Boolean,transition:String,iconPrefix:String,closeOnPopstate:Boolean,closeIconPosition:E("top-right"),destroyOnClose:Boolean,safeAreaInsetTop:Boolean,safeAreaInsetBottom:Boolean}),[Mt,Ce]=oe("popup");var Vt=ae({name:Mt,inheritAttrs:!1,props:zt,emits:["open","close","opened","closed","keydown","update:show","clickOverlay","clickCloseIcon"],setup(e,{emit:n,attrs:o,slots:s}){let a,r;const h=M(),f=M(),d=Ae(()=>e.show||!e.lazyRender),C=_(()=>{const m={zIndex:h.value};if(L(e.duration)){const w=e.position==="center"?"animationDuration":"transitionDuration";m[w]=`${e.duration}s`}return m}),u=()=>{a||(a=!0,h.value=e.zIndex!==void 0?+e.zIndex:xt(),n("open"))},v=()=>{a&&It(e.beforeClose,{done(){a=!1,n("close"),n("update:show",!1)}})},y=m=>{n("clickOverlay",m),e.closeOnClickOverlay&&v()},O=()=>{if(e.overlay){const m=$({show:e.show,class:e.overlayClass,zIndex:h.value,duration:e.duration,customStyle:e.overlayStyle,role:e.closeOnClickOverlay?"button":void 0,tabindex:e.closeOnClickOverlay?0:void 0},e.overlayProps);return c(At,D(m,ye(),{onClick:y}),{default:s["overlay-content"]})}},A=m=>{n("clickCloseIcon",m),v()},S=()=>{if(e.closeable)return c(Z,{role:"button",tabindex:0,name:e.closeIcon,class:[Ce("close-icon",e.closeIconPosition),Ye],classPrefix:e.iconPrefix,onClick:A},null)};let k;const Q=()=>{k&&clearTimeout(k),k=setTimeout(()=>{n("opened")})},q=()=>n("closed"),le=m=>n("keydown",m),j=d(()=>{var m;const{destroyOnClose:w,round:z,position:F,safeAreaInsetTop:ie,safeAreaInsetBottom:p,show:ee}=e;if(!(!ee&&w))return Te(c("div",D({ref:f,style:C.value,role:"dialog",tabindex:0,class:[Ce({round:z,[F]:F}),{"van-safe-area-top":ie,"van-safe-area-bottom":p}],onKeydown:le},o,ye()),[(m=s.default)==null?void 0:m.call(s),S()]),[[Ee,ee]])}),X=()=>{const{position:m,transition:w,transitionAppear:z}=e,F=m==="center"?"van-fade":`van-popup-slide-${m}`;return c(Oe,{name:w||F,appear:z,onAfterEnter:Q,onAfterLeave:q},{default:j})};return N(()=>e.show,m=>{m&&!a&&(u(),o.tabindex===0&&G(()=>{var w;(w=f.value)==null||w.focus()})),!m&&a&&(a=!1,n("close"))}),ue({popupRef:f}),Pt(f,()=>e.show&&e.lockScroll),re("popstate",()=>{e.closeOnPopstate&&(v(),r=!1)}),de(()=>{e.show&&u()}),vt(()=>{r&&(n("update:show",!0),r=!1)}),xe(()=>{e.show&&e.teleport&&(v(),r=!0)}),Be(Ze,()=>e.show),()=>e.teleport?c(Pe,{to:e.teleport},{default:()=>[O(),X()]}):c(ht,null,[O(),X()])}});const Rt=ce(Vt);function ze(e){return Array.isArray(e)?!e.length:e===0?!1:!e}function _t(e,n){if(ze(e)){if(n.required)return!1;if(n.validateEmpty===!1)return!0}return!(n.pattern&&!n.pattern.test(String(e)))}function Nt(e,n){return new Promise(o=>{const s=n.validator(e,n);if(pe(s)){s.then(o);return}o(s)})}function ke(e,n){const{message:o}=n;return Xe(o)?o(e,n):o||""}function Dt({target:e}){e.composing=!0}function Ie({target:e}){e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}function $t(e,n){const o=Je();e.style.height="auto";let s=e.scrollHeight;if(we(n)){const{maxHeight:a,minHeight:r}=n;a!==void 0&&(s=Math.min(s,a)),r!==void 0&&(s=Math.max(s,r))}s&&(e.style.height=`${s}px`,Qe(o))}function jt(e,n){return e==="number"&&(e="text",n??(n="decimal")),e==="digit"&&(e="tel",n??(n="numeric")),{type:e,inputmode:n}}function B(e){return[...e].length}function se(e,n){return[...e].slice(0,n).join("")}const[Ft,I]=oe("field"),Wt={id:String,name:String,leftIcon:String,rightIcon:String,autofocus:Boolean,clearable:Boolean,maxlength:T,max:Number,min:Number,formatter:Function,clearIcon:E("clear"),modelValue:ot(""),inputAlign:String,placeholder:String,autocomplete:String,autocapitalize:String,autocorrect:String,errorMessage:String,enterkeyhint:String,clearTrigger:E("focus"),formatTrigger:E("onChange"),spellcheck:{type:Boolean,default:null},error:{type:Boolean,default:null},disabled:{type:Boolean,default:null},readonly:{type:Boolean,default:null},inputmode:String},Ht=$({},dt,Wt,{rows:T,type:E("text"),rules:Array,autosize:[Boolean,Object],labelWidth:T,labelClass:J,labelAlign:String,showWordLimit:Boolean,errorMessageAlign:String,colon:{type:Boolean,default:null}});var qt=ae({name:Ft,props:Ht,emits:["blur","focus","clear","keypress","clickInput","endValidate","startValidate","clickLeftIcon","clickRightIcon","update:modelValue"],setup(e,{emit:n,slots:o}){const s=ft(),a=Le({status:"unvalidated",focused:!1,validateMessage:""}),r=M(),h=M(),f=M(),{parent:d}=et(at),C=()=>{var t;return String((t=e.modelValue)!=null?t:"")},u=t=>{if(L(e[t]))return e[t];if(d&&L(d.props[t]))return d.props[t]},v=_(()=>{const t=u("readonly");if(e.clearable&&!t){const l=C()!=="",i=e.clearTrigger==="always"||e.clearTrigger==="focus"&&a.focused;return l&&i}return!1}),y=_(()=>f.value&&o.input?f.value():e.modelValue),O=_(()=>{var t;const l=u("required");return l==="auto"?(t=e.rules)==null?void 0:t.some(i=>i.required):l}),A=t=>t.reduce((l,i)=>l.then(()=>{if(a.status==="failed")return;let{value:g}=y;if(i.formatter&&(g=i.formatter(g,i)),!_t(g,i)){a.status="failed",a.validateMessage=ke(g,i);return}if(i.validator)return ze(g)&&i.validateEmpty===!1?void 0:Nt(g,i).then(b=>{b&&typeof b=="string"?(a.status="failed",a.validateMessage=b):b===!1&&(a.status="failed",a.validateMessage=ke(g,i))})}),Promise.resolve()),S=()=>{a.status="unvalidated",a.validateMessage=""},k=()=>n("endValidate",{status:a.status,message:a.validateMessage}),Q=(t=e.rules)=>new Promise(l=>{S(),t?(n("startValidate"),A(t).then(()=>{a.status==="failed"?(l({name:e.name,message:a.validateMessage}),k()):(a.status="passed",l(),k())})):l()}),q=t=>{if(d&&e.rules){const{validateTrigger:l}=d.props,i=he(l).includes(t),g=e.rules.filter(b=>b.trigger?he(b.trigger).includes(t):i);g.length&&Q(g)}},le=t=>{var l;const{maxlength:i}=e;if(L(i)&&B(t)>+i){const g=C();if(g&&B(g)===+i)return g;const b=(l=r.value)==null?void 0:l.selectionEnd;if(a.focused&&b){const V=[...t],R=V.length-+i;return V.splice(b-R,R),V.join("")}return se(t,+i)}return t},j=(t,l="onChange")=>{var i,g;const b=t;t=le(t);const V=B(b)-B(t);if(e.type==="number"||e.type==="digit"){const P=e.type==="number";if(t=tt(t,P,P),l==="onBlur"&&t!==""&&(e.min!==void 0||e.max!==void 0)){const x=nt(+t,(i=e.min)!=null?i:-1/0,(g=e.max)!=null?g:1/0);+t!==x&&(t=x.toString())}}let R=0;if(e.formatter&&l===e.formatTrigger){const{formatter:P,maxlength:x}=e;if(t=P(t),L(x)&&B(t)>+x&&(t=se(t,+x)),r.value&&a.focused){const{selectionEnd:te}=r.value,ge=se(b,te);R=B(P(ge))-B(ge)}}if(r.value&&r.value.value!==t)if(a.focused){let{selectionStart:P,selectionEnd:x}=r.value;if(r.value.value=t,L(P)&&L(x)){const te=B(t);V?(P-=V,x-=V):R&&(P+=R,x+=R),r.value.setSelectionRange(Math.min(P,te),Math.min(x,te))}}else r.value.value=t;t!==e.modelValue&&n("update:modelValue",t)},X=t=>{t.target.composing||j(t.target.value)},m=()=>{var t;return(t=r.value)==null?void 0:t.blur()},w=()=>{var t;return(t=r.value)==null?void 0:t.focus()},z=()=>{const t=r.value;e.type==="textarea"&&e.autosize&&t&&$t(t,e.autosize)},F=t=>{a.focused=!0,n("focus",t),G(z),u("readonly")&&m()},ie=t=>{a.focused=!1,j(C(),"onBlur"),n("blur",t),!u("readonly")&&(q("onBlur"),G(z),lt())},p=t=>n("clickInput",t),ee=t=>n("clickLeftIcon",t),Me=t=>n("clickRightIcon",t),Ve=t=>{Y(t),n("update:modelValue",""),n("clear",t)},fe=_(()=>{if(typeof e.error=="boolean")return e.error;if(d&&d.props.showError&&a.status==="failed")return!0}),Re=_(()=>{const t=u("labelWidth"),l=u("labelAlign");if(t&&l!=="top")return{width:ve(t)}}),_e=t=>{t.keyCode===13&&(!(d&&d.props.submitOnEnter)&&e.type!=="textarea"&&Y(t),e.type==="search"&&m()),n("keypress",t)},me=()=>e.id||`${s}-input`,Ne=()=>a.status,De=()=>{const t=I("control",[u("inputAlign"),{error:fe.value,custom:!!o.input,"min-height":e.type==="textarea"&&!e.autosize}]);if(o.input)return c("div",{class:t,onClick:p},[o.input()]);const l={id:me(),ref:r,name:e.name,rows:e.rows!==void 0?+e.rows:void 0,class:t,disabled:u("disabled"),readonly:u("readonly"),autofocus:e.autofocus,placeholder:e.placeholder,autocomplete:e.autocomplete,autocapitalize:e.autocapitalize,autocorrect:e.autocorrect,enterkeyhint:e.enterkeyhint,spellcheck:e.spellcheck,"aria-labelledby":e.label?`${s}-label`:void 0,"data-allow-mismatch":"attribute",onBlur:ie,onFocus:F,onInput:X,onClick:p,onChange:Ie,onKeypress:_e,onCompositionend:Ie,onCompositionstart:Dt};return e.type==="textarea"?c("textarea",D(l,{inputmode:e.inputmode}),null):c("input",D(jt(e.type,e.inputmode),l),null)},$e=()=>{const t=o["left-icon"];if(e.leftIcon||t)return c("div",{class:I("left-icon"),onClick:ee},[t?t():c(Z,{name:e.leftIcon,classPrefix:e.iconPrefix},null)])},je=()=>{const t=o["right-icon"];if(e.rightIcon||t)return c("div",{class:I("right-icon"),onClick:Me},[t?t():c(Z,{name:e.rightIcon,classPrefix:e.iconPrefix},null)])},Fe=()=>{if(e.showWordLimit&&e.maxlength){const t=B(C());return c("div",{class:I("word-limit")},[c("span",{class:I("word-num")},[t]),yt("/"),e.maxlength])}},We=()=>{if(d&&d.props.showErrorMessage===!1)return;const t=e.errorMessage||a.validateMessage;if(t){const l=o["error-message"],i=u("errorMessageAlign");return c("div",{class:I("error-message",i)},[l?l({message:t}):t])}},He=()=>{const t=u("labelWidth"),l=u("labelAlign"),i=u("colon")?":":"";if(o.label)return[o.label(),i];if(e.label)return c("label",{id:`${s}-label`,for:o.input?void 0:me(),"data-allow-mismatch":"attribute",onClick:g=>{Y(g),w()},style:l==="top"&&t?{width:ve(t)}:void 0},[e.label+i])},qe=()=>[c("div",{class:I("body")},[De(),v.value&&c(Z,{ref:h,name:e.clearIcon,class:I("clear")},null),je(),o.button&&c("div",{class:I("button")},[o.button()])]),Fe(),We()];return ue({blur:m,focus:w,validate:Q,formValue:y,resetValidation:S,getValidationStatus:Ne}),Be(it,{customValue:f,resetValidation:S,validateWithTrigger:q}),N(()=>e.modelValue,()=>{j(C()),S(),q("onChange"),G(z)}),de(()=>{j(C(),e.formatTrigger),G(z)}),re("touchstart",Ve,{target:_(()=>{var t;return(t=h.value)==null?void 0:t.$el})}),()=>{const t=u("disabled"),l=u("labelAlign"),i=$e(),g=()=>{const b=He();return l==="top"?[i,b].filter(Boolean):b||[]};return c(ut,{size:e.size,class:I({error:fe.value,disabled:t,[`label-${l}`]:l}),center:e.center,border:e.border,isLink:e.isLink,clickable:e.clickable,titleStyle:Re.value,valueClass:I("value"),titleClass:[I("label",[l,{required:O.value}]),e.labelClass],arrowDirection:e.arrowDirection},{icon:i&&l!=="top"?()=>i:null,title:g,value:qe,extra:o.extra})}}});const gn=ce(qt);let U=0;function Kt(e){e?(U||document.body.classList.add("van-toast--unclickable"),U++):U&&(U--,U||document.body.classList.remove("van-toast--unclickable"))}const[Ut,W]=oe("toast"),Gt=["show","overlay","teleport","transition","overlayClass","overlayStyle","closeOnClickOverlay","zIndex"],Yt={icon:String,show:Boolean,type:E("text"),overlay:Boolean,message:T,iconSize:T,duration:st(2e3),position:E("middle"),teleport:[String,Object],wordBreak:String,className:J,iconPrefix:String,transition:E("van-fade"),loadingType:String,forbidClick:Boolean,overlayClass:J,overlayStyle:Object,closeOnClick:Boolean,closeOnClickOverlay:Boolean,zIndex:T};var Zt=ae({name:Ut,props:Yt,emits:["update:show"],setup(e,{emit:n,slots:o}){let s,a=!1;const r=()=>{const v=e.show&&e.forbidClick;a!==v&&(a=v,Kt(a))},h=v=>n("update:show",v),f=()=>{e.closeOnClick&&h(!1)},d=()=>clearTimeout(s),C=()=>{const{icon:v,type:y,iconSize:O,iconPrefix:A,loadingType:S}=e;if(v||y==="success"||y==="fail")return c(Z,{name:v||y,size:O,class:W("icon"),classPrefix:A},null);if(y==="loading")return c(St,{class:W("loading"),size:O,type:S},null)},u=()=>{const{type:v,message:y}=e;if(o.message)return c("div",{class:W("text")},[o.message()]);if(L(y)&&y!=="")return v==="html"?c("div",{key:0,class:W("text"),innerHTML:String(y)},null):c("div",{class:W("text")},[y])};return N(()=>[e.show,e.forbidClick],r),N(()=>[e.show,e.type,e.message,e.duration],()=>{d(),e.show&&e.duration>0&&(s=setTimeout(()=>{h(!1)},e.duration))}),de(r),bt(r),()=>c(Rt,D({class:[W([e.position,e.wordBreak==="normal"?"break-normal":e.wordBreak,{[e.type]:!e.icon}]),e.className],lockScroll:!1,onClick:f,onClosed:d,"onUpdate:show":h},rt(e,Gt)),{default:()=>[C(),u()]})}});function Jt(){const e=Le({show:!1}),n=a=>{e.show=a},o=a=>{$(e,a,{transitionAppear:!0}),n(!0)},s=()=>n(!1);return ue({open:o,close:s,toggle:n}),{open:o,close:s,state:e,toggle:n}}function Qt(e){const n=Ct(e),o=document.createElement("div");return document.body.appendChild(o),{instance:n.mount(o),unmount(){n.unmount(),document.body.removeChild(o)}}}const Xt={icon:"",type:"text",message:"",className:"",overlay:!1,onClose:void 0,onOpened:void 0,duration:2e3,teleport:"body",iconSize:void 0,iconPrefix:void 0,position:"middle",transition:"van-fade",forbidClick:!1,loadingType:void 0,overlayClass:"",overlayStyle:void 0,closeOnClick:!1,closeOnClickOverlay:!1};let ne=[],pt=!1,Se=$({},Xt);const en=new Map;function tn(e){return we(e)?e:{message:e}}function nn(){const{instance:e}=Qt({setup(){const n=M(""),{open:o,state:s,close:a,toggle:r}=Jt(),h=()=>{},f=()=>c(Zt,D(s,{onClosed:h,"onUpdate:show":r}),null);return N(n,d=>{s.message=d}),kt().render=f,{open:o,close:a,message:n}}});return e}function on(){if(!ne.length||pt){const e=nn();ne.push(e)}return ne[ne.length-1]}function vn(e={}){if(!ct)return{};const n=on(),o=tn(e);return n.open($({},Se,en.get(o.type||Se.type),o)),n}export{gn as F,Rt as P,vn as a,Zt as s};
